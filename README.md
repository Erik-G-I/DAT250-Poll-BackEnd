Redone code from expass2
